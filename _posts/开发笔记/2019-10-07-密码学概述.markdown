---
layout: post
title:  "密码学概述"
date:   2019-10-07 14:11:31 +0800
categories: 开发笔记
---

![](http://yuqiangcoder.com/assets/postImages/ios/201910/header.jpg)
该图片由<a href="https://pixabay.com/zh/users/FotoArt-Treu-796002/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=4165613">Michael Treu</a>在<a href="https://pixabay.com/zh/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=4165613">Pixabay</a>上发布

## 概述

密码发展进程：

1. 古典密码算法
    利用代替技术，置换技术
2. 对称加密算法
    包括流密码和分组密码 如： RC4、DES和AES
3. 非对称加密算法
    包括RSA、背包密码、椭圆曲线等
    
目前在数据通信中使用最普遍的算法有DES算法、AES算法、RSA算法和ECC算法等。

密码学是研究密码系统或通信安全的一门科学，它包含两个分支

1. 密码编码学
    * 机密性
    * 认证
2. 密码分析学
    * 破译加密消息
    * 伪造消息

密码学的目标：

1. 机密性
2. 数据完整性
3. 认证和不可否认性

按所用秘钥数分类：

1. 单秘钥密码（对称、秘密钥、私钥、传统密码）
    * 优点：运行速度快，具有可靠的保密强度
    * 不足：不便秘钥交换和管理

2. 双钥密码（非对称、公钥密码）
    * 优点：便于秘钥交换和管理，还可用于消息认证（数字签名）
    * 不足：运行速度缓慢，其安全性所依赖的数学难题的复杂性一般都未能证明

3. 无密码密码（如单向，散列，随机化）

柯克霍夫准则：
系统的保密性不依赖于对加密体制或算法的保密，而依赖于对秘钥的保密。

![](http://yuqiangcoder.com/assets/postImages/ios/201910/cipher.png)

## 对称加密

传统密码、常规密码、私钥密码、单钥密码；
发送方和接收方共享同一个共同的秘钥。

基本成分：

1. 明文（`plaintext`）：信息的原始形式，一般是信息的基本单元（字符，数字，符号等）的有限排列
2. 密文（`ciphertext`）：明文经过加密以后的结果形式
3. 加密变换（`encryption`）：从明文到密文的变换过程
4. 解密变换（`decryption`）：从密文还原成明文的过程
5. 秘钥（`key`）：用于加解密变换的关键信息，视其用于加解密而分别称为加密秘钥和解密秘钥

![](http://yuqiangcoder.com/assets/postImages/ios/201910/legacy_cipher_mode.png)

对称密码保证安全的两个必备条件：

1. 机密算法必须是足够强的
2. 只有发送者和接收者知道秘钥

#### DES

数据加密标准（DES, Data Encryption Standard）
曾被美国国家标准局（`NBS`）确定为联邦信息处理标准（`FIPS PUB 46`），得到最广泛的应用，特别是在金融领域，曾是对称密码体制的世界标准。

#### AES

由于`DES`作为数据加密标准自1977年颁布以来，已超期服役了很长时间，1997年美国国家标准技术研究所NIST向密码学界征寻一个用于新的数据加密标准，名为高级加密标准AES候选算法的提议。

NIST规定候选算法必须满足下面的要求：

1. 密码必须是没有密级的，决不能像商业秘密那样来保护它
2. 算法的全部描述必须公开披露
3. 密码必须可以在世界范围内免费试用
4. 密码系统支持至少218bit长的分组
5. 密码支持的密钥长度至少为128bit、192bit和256bit
6. 安全性不低于3DES

#### 对称密码体制缺陷

1. 加密密钥和解密密钥相同
    由加密密钥容易推导得到与之对应的解密密钥
2. 密钥传输
    消息的发送方和接收方必须在密文传输之前通过安全信道进行密码传输
3. 密钥分配
    加密者指定一个密钥后，必须得想方设法把密钥发出去给解密者，同时还得小心翼翼确保密钥不被泄漏
4. 密钥管理问题
    在有多个用户的网络中，任何两个用户之间都需要有共享的加密密钥，当网络中的用户n很大时，需要管理的密钥数目非常大。
5. 没有签名功能
    当主体A收到主体B的数据时，无法向第三方证明此数据确实来源于B

## 非对称加密

公钥密码的基本思想是将传统密码的密钥一分为二， 分为加密密钥和解密密钥；

将两个密钥分别称为公钥、私钥。

特点：

1. 公钥是公开的，任何人都可获得
2. 私钥保密，需要妥善保管
3. 与对称密码密码体制相比，公钥体制的密钥在处理和发送上更为方便而且安全。
4. 加密和解密能力分开
5. 多个用户加密的消息只能由一个用户解读（用于公共网络中的实现保密通信）
6. 只能由一个用户加密消息而使多个用户可以解读（可用于认证系统中对消息进行数字签名）
7. 无需事先分配密钥

功能：

1. 通信加密：公钥加密，私钥解密
2. 认证： 私钥加密，公钥解密

加密过程：
![](http://yuqiangcoder.com/assets/postImages/ios/201910/encryption_process.png)

加密体制：
![](http://yuqiangcoder.com/assets/postImages/ios/201910/encryption_mode.png)

认证过程：
![](http://yuqiangcoder.com/assets/postImages/ios/201910/auth_ process.png)

认证体制：
![](http://yuqiangcoder.com/assets/postImages/ios/201910/auth_mode.png)

公钥保密和认证体制：
![](http://yuqiangcoder.com/assets/postImages/ios/201910/encryption_auth_mode.png)

#### RSA

`RSA`算法是第一个比较完善、应用最广泛的公钥密码算法。

该算法的数学基础是初等数论中的欧拉定力，并建立在大整数因子分解的困难性之上，目前还不存在一般性的有效解决算法。

优点：

是第一个能同时用于加密和数字签名的算法，也易于理解和操作，也是被研究得最广泛的公钥算法，经历了各种攻击的考验，逐渐为人们接受，普遍认为是目前最优秀的公钥方案之一。该算法的加密密钥和加密算法分开，使得密钥分配更为方便。

缺点：

产生密钥很麻烦，受到素数产生的技术的限制，因而难以做到一次一密；
分组长度太大，为保证安全性，`n`至少也要600位以上，使运算代价很高，尤其是速度较慢。

## Hash

数据安全：

1. 机密性
2. 完整性
3. 认证性

密码技术主要保证数据的机密性；

`Hash`函数能保证数据的完整性和认证性；

`Hash`函数也叫散列函数、哈希函数、杂凑函数。

散列函数是以公开函数，通常记为`H`，用于将任意长的消息`M`映射为较短的、固定长度的一个值作为认证符，记为`H(M)`，经常称函数值`H(M)`为**散列值**、**哈希值**、**杂凑值**、**杂凑码**、**消息摘要**等等。

![](http://yuqiangcoder.com/assets/postImages/ios/201910/hash_mode.png)

从密码角度看，散列函数也可以看作是一种**单向密码体制**，即它从一个明文到密文是不可逆映射，只有加密过程，不能解密。

散列值是消息中所有比特的函数值，因此提供了一种错误检测能力，即改变消息中任何一个比特或几个比特都会使散列值发生改变。

在密码学和数据安全技术中，散列函数是实现有效、安全可靠数字签名和认证的重要工具，是安全认证协议中的重要模块。

* 原像：对于`Hash`函数`h=H(x)`，称`x`为`H`原像。
* 碰撞：因为`H`是多对一映射，所以对于任意给定的`Hash`值`h`，对应有多个原像。如果满足`x≠y`且`H(x)=H(y)`，则称出现碰撞。

应用：

1. 消息认证
    消息认证是用来验证消息完整性的一种机制或服务。
    确保收到的数据确实和发送时的一样（即没有修改、插入、删除或重放）且发送方声称的身份真实有效。
    一般通过使用消息认证码（`MAC`）实现，即带密钥的`Hash`函数。当哈希函数用于提供消息认证功能时，Hash函数值通常称为**消息摘要**。
    
2. 数字签名
    在进行数字签名过程中使用用户的私钥加密消息的`Hash`值，其它任何知道该用户公钥的人都能够通过数字签名验证消息的完整性。攻击者要想篡改消息，则需要知道用户私钥。
    
    使用`Hash`的优点：
    
   * 提高签名的速度
       先计算消息摘要`z=H(M)`，再计算签名`y=Sig(z)`
       
   * 可以不泄露签名所对应的消息
       签名`y`应当公开，消息摘要`z`可以公开以便验证签名，消息`m`则可以保密
       
   * 可以将对消息的签名和加密分开处理
       可以在不同层次提供消息的完整性和机密性
    
#### MD5

#### SHA1
#### SHA256

[jekyll-docs]: https://jekyllrb.com/docs/home
[jekyll-gh]:   https://github.com/jekyll/jekyll
[jekyll-talk]: https://talk.jekyllrb.com/

