---
layout: post
title:  "RxSwift æˆé•¿ä¹‹è·¯---åŸºæœ¬æ¦‚å¿µå’Œè¯­æ³•"
date:   2016-12-28 10:17:31 +0800
categories: å‡½æ•°å¼Swift
---
> æ›´æ–°æ—¶é—´: 2017-02-28
[RxSwift + Moya + ObjectMapper + MVVM çš„ç½‘ç»œè¯·æ±‚](http://www.jianshu.com/p/2e0dfba02ae5)

# è¯´æ˜
åˆšå¼€å§‹æ¥è§¦`RxSwift`, å¾ˆå¤šæ¦‚å¿µç†ä¸æ¸…; è¯•ç€é˜…è¯»å®˜æ–¹çš„`playground`, æ— å¥ˆè‹±è¯­æ°´å¹³æœ‰é™, çœ‹ç€è‹±æ–‡æ–‡æ¡£,æ›´åŠ è¿·ç³Š. å‡ ç»å‘¨æŠ˜,æ‰¾åˆ°è¿™ç¯‡å¾ˆå¥½çš„æ•™ç¨‹, ä½œè€…æ•´ç†çš„éå¸¸æ¸…æ™°, æ„Ÿè°¢ä½œè€…çš„åˆ†äº«ç²¾ç¥.
è¯·å„ä½çœ‹å®˜ç§»æ­¥åŸæ–‡[ç”°è…¾é£çš„åšå®¢ ã€iOSå¼€å‘ã€‘RxSwiftå…¥å‘è§£è¯»-ä½ æ‰€éœ€è¦çŸ¥é“çš„å„ç§æ¦‚å¿µ](http://www.codertian.com/2016/11/27/RxSwift-ru-keng-ji-read-document/)

æ­¤å¤„æ•´ç†çš„ä¸å¤Ÿæ¸…æ™°, ä»…ä»…æ˜¯ä¸ºäº†è‡ªå·±å¯¹è¿™äº›æ¦‚å¿µçš„è¿›ä¸€æ­¥çš„è®°å¿†.æ‰€ä»¥ä¸ºäº†ä¸è€½è¯¯å¤§å®¶çš„æ—¶é—´, è¯·å¤§å®¶ç‚¹å‡»è¿™é‡Œ,é˜…è¯»åŸæ–‡ä½œè€…çš„åšå®¢[æ²¸æ²¸è…¾ï¼ˆç‹’ç‹’ï¼‰](http://www.codertian.com/)

# æ–‡ä»¶ç›®å½•é¢„è§ˆ, åŸºæœ¬æ¦‚å¿µåˆ’åˆ†

![ç›®å½•](http://upload-images.jianshu.io/upload_images/3538284-56ec8dfc17415f0f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

![å¯ä¾æ¬¡å–æ¶ˆæ³¨é‡Š,åœ¨æ§åˆ¶å°æŸ¥çœ‹è¿è¡Œç»“æœ](http://upload-images.jianshu.io/upload_images/3538284-411971e968154f7c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

# å†…å®¹æ‹†åˆ†
## åŸºæœ¬æ¦‚å¿µ
>1. `Observable` å’Œ `Observer`
`Observable` æ˜¯å¯è¢«è§‚å¯Ÿçš„,ç†è§£ä¸ºäº‹ä»¶æº.
`Observer` æ˜¯æˆ‘ä»¬çš„è§‚å¯Ÿè€…, æ”¶åˆ°äº‹ä»¶å, äº‹ä»¶çš„å¤„ç†è€…
è§‚å¯Ÿè€…éœ€è¦è®¢é˜…(`subscribe`) è¢«è§‚å¯Ÿè€…,æ‰èƒ½æ”¶åˆ°`Observable`çš„äº‹ä»¶é€šçŸ¥æ¶ˆæ¯
2. åˆ›å»ºå’Œè®¢é˜…è¢«è§‚å¯Ÿè€…
åˆ›å»ºè¢«è§‚å¯Ÿè€…å…¶å®å°±æ˜¯åˆ›å»ºä¸€ä¸ª`Observable`çš„`sequence`,å°±æ˜¯åˆ›å»ºä¸€ä¸ªæµ, ç„¶åå°±å¯ä»¥è¢«è®¢é˜…`subscribe`, è¿™æ ·è¢«è§‚å¯Ÿè€…å‘å‡ºäº‹ä»¶, æˆ‘ä»¬å°±èƒ½åšç›¸åº”çš„å¤„ç†
3. DisposeBag
`DisposeBag` å…¶å®ç›¸å½“äº`iOS`ä¸­`ARC`, åœ¨é€‚å½“çš„æ—¶å€™é”€æ¯è§‚å¯Ÿè€…, ç†è§£ä¸ºå†…å­˜ç®¡ç†è€…
4. subscribe
`subscribe`æ˜¯è®¢é˜…`sequence`å‘å‡ºçš„äº‹ä»¶, æ¯”å¦‚`next`äº‹ä»¶, `error`äº‹ä»¶ç­‰. è€Œ`subscribe(onNext:)`æ˜¯ç›‘å¬`sequence`å‘å‡ºçš„`next`äº‹ä»¶ä¸­çš„`element`è¿›è¡Œå¤„ç†, ä»–ä¼šå¿½ç•¥`error`å’Œ`complete`äº‹ä»¶. ç›¸å¯¹åº”çš„è¿˜æœ‰`subscribe(onError:)` å’Œ `subscribe(onCompleted:)`

###  `never` æ˜¯åˆ›å»ºä¸€ä¸ª`sequence`, ä½†æ˜¯ä¸å‘å‡ºä»»ä½•äº‹ä»¶ä¿¡å·
```
Observable<String>.never().subscribe { (_) in
Â  Â  Â  Â  Â  Â  print("ä¸ä¼šæ‰“å°è¿™å¥è¯, å› ä¸ºä¸ä¼šè¢«æ‰§è¡Œ")
Â  Â  Â  Â  }.addDisposableTo(DisposeBag())
```
###  `empty` æ˜¯åˆ›å»ºä¸€ä¸ªç©ºçš„`sequence`, åªèƒ½å‘å‡ºä¸€ä¸ª`complete`äº‹ä»¶
```
Observable<Int>.empty().subscribe { event in print(event) }.addDisposableTo(disposeBag)
```
### `just` æ˜¯åˆ›å»ºä¸€ä¸ª`sequence`èƒ½å‘å‡ºç‰¹å®šçš„äº‹ä»¶, èƒ½æ­£å¸¸ç»“æŸ 
```
Observable<String>.just("ğŸ’—").subscribe { (string) in
            print(string)
        }.addDisposableTo(DisposeBag())
```
### `of` æ˜¯åˆ›å»ºä¸€ä¸ª`sequence` èƒ½å‘å‡ºå¾ˆå¤šäº‹ä»¶ä¿¡å·, subscribeåªç›‘å¬äº‹ä»¶
```
Observable.of("1--", "2--", "3--", "4--").subscribe { (str) in
            print(str)
        }.addDisposableTo(DisposeBag())
        
        Observable.of("1--", "2--", "3--", "4--").subscribe(onNext: { (str) in
            print(str)
        }, onError: nil, onCompleted: nil, onDisposed: nil).addDisposableTo(DisposeBag())     
```
### `from` æ˜¯ä»é›†åˆä¸­åˆ›å»º`sequence`, ä¾‹å¦‚: å­—å…¸, æ•°ç»„, `set`
```
Observable.from(["ğŸ˜€", "ğŸ˜¬", "ğŸ˜‚", "ğŸ˜…"]).subscribe(onNext: { print($0)
        }).addDisposableTo(DisposeBag())
```
### `create` æˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰å¯è§‚å¯Ÿçš„`sequence`
```
let myJust: (String) -> Observable<String> = { (element: String) -> Observable<String> in
            return Observable.create({ (observer) -> Disposable in
                observer.on(.next(element))
                observer.on(.completed)
                return Disposables.create()
            })
        }
        myJust("è‡ªå®šä¹‰å¯è§‚å¯Ÿçš„sequence").subscribe(onNext: { (str) in
            print(str)
        }).addDisposableTo(DisposeBag())
```
### `range` å°±æ˜¯åˆ›å»ºä¸€ä¸ª`sequence`, ä»–å¯ä»¥å‘å‡ºè¿™ä¸ªèŒƒå›´ä»å¼€å§‹åˆ°ç»“æŸçš„æ‰€æœ‰äº‹ä»¶
```
Observable.range(start: 1, count: 10).subscribe { print($0)
        }.addDisposableTo(DisposeBag())
```
### `repeatElement` åˆ›å»ºä¸€ä¸ª`sequence`, å‘å‡ºç‰¹å®šäº‹ä»¶næ¬¡
```
Observable.repeatElement("âš¾ï¸").take(3).subscribe { print($0)
        }.addDisposableTo(DisposeBag())
```
### `generate` æ˜¯åˆ›å»ºä¸€ä¸ªå¯è§‚å¯Ÿçš„`sequence`, å½“åˆå§‹åŒ–çš„æ¡ä»¶ä¸º`true`æ—¶, ä»–å°±ä¼šå‘å‡ºæ‰€å¯¹åº”çš„äº‹ä»¶
```
Observable.generate(initialState: 0, condition: { (element) -> Bool in
            element < 5
        }) { (element) -> Int in
            element + 1
        }.subscribe { (element) in
            print(element)
        }.addDisposableTo(DisposeBag())
```
### `deferred` (å»¶æœŸ) ä¼šä¸ºæ¯ä¸€ä¸ªè®¢é˜…è€…`observer`, åˆ›å»ºä¸€ä¸ªæ–°çš„å¯è§‚å¯Ÿåºåˆ—
```
var count = 1
        let deferredSequence = Observable<String>.deferred { () -> Observable<String> in
            print("Creating \(count)")
            count += 1
            return Observable.create({ (observer) -> Disposable in
                observer.onNext("ğŸ„ğŸ½â€â™€ï¸")
                observer.onNext("ğŸ„")
                observer.onNext("â›·")
                return Disposables.create()
            })
        }
        deferredSequence.subscribe { print($0)
        }.addDisposableTo(DisposeBag())
        deferredSequence.subscribe { print($0)
        }.addDisposableTo(DisposeBag())
```
### `error` åˆ›å»ºä¸€ä¸ªå¯è§‚å¯Ÿåºåˆ—, ä½†ä¸å‘å‡ºä»»ä½•æ­£å¸¸çš„äº‹ä»¶, åªå‘å‡º`error`äº‹ä»¶å¹¶ç»“æŸ
```

```
### `doOno doOnNext( :)`æ–¹æ³•å°±æ˜¯åœ¨`subscribe(onNext:)`å‰è°ƒç”¨ï¼Œ`doOnCompleted(:)`å°±æ˜¯åœ¨`subscribe(onCompleted:)`å‰é¢è°ƒç”¨çš„ã€‚
```
Observable.of("ğŸš—", "ğŸš•", "ğŸš™", "ğŸšŒ").do(onNext: { (str) in
            print("doOn--\(str)")
        }, onError: nil, onCompleted: nil, onSubscribe: nil, onDispose: nil).subscribe { (str) in
            print(str)
        }.addDisposableTo(DisposeBag())
```

## Subjectçš„ä½¿ç”¨
> `Subject`æ˜¯ `Observable` å’Œ `observer` ä¹‹é—´çš„æ¡¥æ¢, ä¸€ä¸ª`Subject` æ—¢æ˜¯`Observable` ä¹Ÿæ˜¯ `observer`, ä»–æ—¢å¯ä»¥å‘å‡ºäº‹ä»¶,åˆå¯ä»¥ç›‘å¬äº‹ä»¶
> `PublishSubject`, `ReplaySubject`å’Œ`BehaviorSubject`æ˜¯ä¸ä¼šè‡ªåŠ¨å‘å‡º`completed`äº‹ä»¶çš„ã€‚

### `publishSubject`  å½“ä½ è®¢é˜…`publishSubject`çš„æ—¶å€™, ä½ åªèƒ½æ¥æ”¶åˆ°è®¢é˜…ä»–ä¹‹åå‘ç”Ÿçš„äº‹ä»¶, `subject.onNext()`å‘å‡º`onNext`äº‹ä»¶ï¼Œå¯¹åº”çš„è¿˜æœ‰`onError()`å’Œ`onCompleted()`äº‹ä»¶
```
let publishSubject = PublishSubject<String>()
        let disposeBag = DisposeBag()
        publishSubject.subscribe({ print("1---", $0)
        }).addDisposableTo(disposeBag)
        publishSubject.onNext("ğŸ¶")
        publishSubject.onNext("ğŸ±")
        
        publishSubject.subscribe({ print("2---", $0)
        }).addDisposableTo(disposeBag)
        publishSubject.onNext("ğŸ…°ï¸")
        publishSubject.onNext("ğŸ…±ï¸")
```
### `ReplaySubject` å½“ä½ è®¢é˜…`ReplaySubject`çš„æ—¶å€™, ä½ å¯ä»¥æ¥æ”¶åˆ°è®¢é˜…ä»–ä¹‹åçš„äº‹ä»¶, å•é¡µå¯ä»¥æ¥æ”¶è®¢é˜…ä»–ä¹‹å‰å‘å‡ºçš„äº‹ä»¶, æ¥æ”¶å‡ ä¸ªäº‹ä»¶å–å†³äº`bufferSize`çš„å¤§å°
```
let replaySubject = ReplaySubject<Any>.create(bufferSize: 3)
        let replayDisposeBag = DisposeBag()
        
        replaySubject.subscribe({ print("replaySubject--1--", $0)}).addDisposableTo(replayDisposeBag)
        replaySubject.onNext("A")
        replaySubject.onNext("B")
        replaySubject.onNext("C")
        replaySubject.onNext("D")
        
        replaySubject.subscribe({ print("replaySubject--2--", $0)}).addDisposableTo(replayDisposeBag)
        replaySubject.onNext("ä¸€")
        replaySubject.onNext("äºŒ")
```
### `BehaviorSubject `å½“ä½ è®¢é˜…äº†`BehaSubject`, ä½ ä¼šæ¥æ”¶åˆ°è®¢é˜…ä¹‹å‰çš„æœ€åä¸€ä¸ªäº‹ä»¶
```
let behaviorSubject = BehaviorSubject(value: "ğŸ")
        let behaviorDisposeBag = DisposeBag()
        print("\n\n")
        behaviorSubject.subscribe({ print("BehaviorSubject--1--", $0) }).addDisposableTo(behaviorDisposeBag)
        behaviorSubject.onNext("ğŸŒ")
        behaviorSubject.onNext("ğŸŒ›")
        behaviorSubject.onNext("ğŸŒŸ")
        behaviorSubject.subscribe({ print("BehaviorSubject--2--", $0)} ).addDisposableTo(behaviorDisposeBag)
        behaviorSubject.onNext("ğŸŒ")
        behaviorSubject.onNext("ğŸŒ•")
```

> æ³¨: `PublishSubject`, `ReplaySubject`å’Œ`BehaviorSubject`æ˜¯ä¸ä¼šè‡ªåŠ¨å‘å‡º`completed`äº‹ä»¶çš„ã€‚

### `Variable` æ˜¯`behaviorSubject`çš„ä¸€ä¸ªåŒ…è£…ç®±, å°±åƒæ˜¯ä¸€ä¸ªç®±å­ä¸€æ ·, ä½¿ç”¨çš„æ—¶å€™éœ€è¦è°ƒç”¨`asObservable`æ‹†ç®±, é‡Œé¢çš„`value`æ˜¯ä¸€ä¸ª`BehaviorSubject`, ä»–ä¸ä¼šå‘å‡º`error`äº‹ä»¶, ä½†æ˜¯ä¼šè‡ªåŠ¨å‘å‡º`complete`äº‹ä»¶
```
let variable = Variable("ğŸŒ–")
        let variableDisposeBag = DisposeBag()
        variable.asObservable().subscribe({ print("variableDisposeBag--1--", $0)} ).addDisposableTo(variableDisposeBag)
        variable.value = "â˜€ï¸"
        variable.value = "ğŸŒ¤"
        
        variable.asObservable().subscribe({ print("variableDisposeBag--2--", $0)}).addDisposableTo(variableDisposeBag)
        variable.value = "ğŸ”´"
        variable.value = "ğŸ”µ"
```

## è”åˆæ“ä½œ

> è”åˆæ“ä½œå°±æ˜¯æŠŠå¤šä¸ª`Observable`(è¢«è§‚å¯Ÿè€…) åˆå¹¶æˆå•ä¸ª`observable`æµ

### `startWith` åœ¨å‘å‡ºäº‹ä»¶æ¶ˆæ¯ä¹‹å‰, å…ˆå‘å‡ºæŸä¸ªç‰¹å®šçš„äº‹ä»¶æ¶ˆæ¯, æ¯”å¦‚å‘å‡ºäº‹ä»¶2, 3 ,startWith(1),å,ä¼šå…ˆå‘å‡º1, ç„¶åå‘å‡º2, 3
```
Observable.of("2", "3").startWith("1").startWith( "-1", "0").subscribe({ print("startWith---",$0 )}).addDisposableTo(DisposeBag())
```
### `merge` æŠŠä¸¤ä¸ª`Observable` æµåˆå¹¶æˆä¸€ä¸ª`Observable`æµ, æ ¹æ®æ—¶é—´è½´å‘å‡ºå¯¹åº”çš„äº‹ä»¶
```
let mergeDisposeBag = DisposeBag()
        let mergeSubject1 = PublishSubject<String>()
        let mergeSubject2 = PublishSubject<String>()
        
        Observable.of(mergeSubject1, mergeSubject2).merge().subscribe(onNext: { print($0) }, onError: nil, onCompleted: nil, onDisposed: nil).addDisposableTo(mergeDisposeBag)
        mergeSubject1.onNext("ğŸŒ•")
        mergeSubject1.onNext("ğŸŒ–")
        mergeSubject2.onNext("ğŸŒ—")
        mergeSubject1.onNext("ğŸŒ˜")
        mergeSubject2.onNext("ğŸŒ‘")
```
### `zip` ç»‘å®šå°äºç­‰äº8 ä¸ªçš„`Observable`æµ, ç»“åˆåœ¨ä¸€èµ·åŠç†, æ³¨: zip æ˜¯ä¸€ä¸ªäº‹ä»¶å¯¹åº”ä¸€ä¸ªäº‹ä»¶, ä¸æ»¡è¶³é…å¯¹çš„å°†ä¼šè¢«æŠ›å¼ƒ
```
let stringSubject = PublishSubject<String>()
        let intSubject = PublishSubject<Int>()
        let zipDisposeBag = DisposeBag()
        
        Observable.zip(stringSubject, intSubject) { (stringElement, intElement) -> String in
            return "\(stringElement) \(intElement)"
            }.subscribe(onNext: { print($0)}).addDisposableTo(zipDisposeBag)
        stringSubject.onNext("A")
        stringSubject.onNext("B")
        intSubject.onNext(1)
        intSubject.onNext(2)
        intSubject.onNext(3)
        stringSubject.onNext("C")
        intSubject.onNext(4)
```

### `combineLatest` ç»‘å®šæœ€å¤šä¸è¶…è¿‡8ä¸ªçš„`Obaservable`, ç»“åˆåœ¨ä¸€èµ·å¤„ç†. å’Œ`zip` ä¸åŒçš„æ˜¯, `combineLast`æ˜¯ä¸€ä¸ªæµçš„äº‹ä»¶å¯¹åº”å¦ä¸€æµçš„'æœ€å'ä¸€ä¸ªäº‹ä»¶, ä¸¤ä¸ªæµçš„äº‹ä»¶éƒ½æ˜¯'æœ€è¿‘'çš„äº‹ä»¶
```
let stringSubject2 = PublishSubject<String>()
        let intSubject2 = PublishSubject<Int>()
        let zipDisposeBag2 = DisposeBag()
        print("\n")
        Observable.combineLatest(stringSubject2, intSubject2) { (stringElement, intElement) -> String in
            return "\(stringElement) \(intElement)"
            }.subscribe(onNext: { print($0)}).addDisposableTo(zipDisposeBag2)
        stringSubject2.onNext("A")
        stringSubject2.onNext("B")
        intSubject2.onNext(1)
        intSubject2.onNext(2)
        intSubject2.onNext(3)
        stringSubject2.onNext("C")
        intSubject2.onNext(4)
```
### `switchLatest` å¯ä»¥å¯¹äº‹ä»¶æµè¿›è¡Œè½¬æ¢, æœ¬æ¥ç›‘å¬çš„`subject1` , æˆ‘ä»¬å¯ä»¥é€šè¿‡æ”¹å˜`variable`é‡Œé¢çš„`value`, æ›´æ¢äº‹ä»¶æº, å˜æˆç›‘å¬`subject2`
```
let switchDisposeBag = DisposeBag()
        let subject1 = BehaviorSubject(value: "ğŸ˜")
        let subject2 = BehaviorSubject(value: "ğŸ˜˜")
        let variable = Variable(subject1)
        variable.asObservable().switchLatest().subscribe({ print($0)}).addDisposableTo(switchDisposeBag)
        subject1.onNext("ğŸ")
        subject1.onNext("ğŸ")
        subject2.onNext("ğŸ")
        variable.value = subject2
        subject1.onNext("ğŸ‰")
        subject2.onNext("ğŸ²")
```

## å˜æ¢æ“ä½œ

> å˜æ¢æ“ä½œ

### `map` é€šè¿‡ä¼ å…¥ä¸€ä¸ªå‡½æ•°é—­åŒ…æŠŠåŸæ¥çš„`sequence` è½¬æ¢ä¸ºä¸€ä¸ªæ–°çš„`sequence`
```
Observable.of(1, 2, 3).map { $0 * $0
            }.subscribe({ print($0)}).addDisposableTo(DisposeBag())
```
### `flatMap` å°†ä¸€ä¸ª`sequence` è½¬æ¢ä¸ºå¦ä¸€ä¸ª`sequence`, å½“ä½ æ¥æ”¶ä¸€ä¸ª`sequence`äº‹ä»¶, ä½ è¿˜æƒ³æ¥æ”¶å…¶ä»–`sequence`å‘å‡ºçš„äº‹ä»¶çš„è¯,å¯ä»¥ä½¿ç”¨`flatMap`, ä»–ä¼šå°†æ¯ä¸€ä¸ª`sequence`äº‹ä»¶è¿›è¡Œå¤„ç†å, ç„¶åå†ä»¥ä¸€ä¸ªæ–°çš„`sequence`å½¢å¼å‘å‡ºäº‹ä»¶.
```
let flatMapDisposeBag = DisposeBag()
        struct Player {
            var score: Variable<Int>
        }
        let ğŸ˜ˆ = Player(score: Variable(80))
        let ğŸ‘» = Player(score: Variable(90))
        let ğŸ’€ = Player(score: Variable(550))
        
        let variablePlayer = Variable(ğŸ˜ˆ)
        variablePlayer.asObservable().flatMapLatest { $0.score.asObservable()
            }.subscribe({ print($0)}).addDisposableTo(flatMapDisposeBag)
        ğŸ˜ˆ.score.value = 85
        variablePlayer.value = ğŸ‘»
        ğŸ˜ˆ.score.value = 95
        ğŸ˜ˆ.score.value = 222
        
        variablePlayer.value = ğŸ’€
        ğŸ‘».score.value = 100
        ğŸ’€.score.value = 666
```

> flatMapLatest åªä¼šæ¥æ”¶æœ€æ–°çš„valueäº‹ä»¶

### `scan` å°±æ˜¯ä¸€ä¸ªåˆå§‹åŒ–çš„æ•°, ç„¶åä¸æ–­çš„æ‹¿å‰ä¸€ä¸ªç»“æœå’Œæœ€æ–°çš„å€¼, è¿›è¡Œå¤„ç†æ“ä½œ
```
Observable.range(start: 1, count: 100).scan(0) { (a, b) -> Int in
            return a + b
            }.subscribe({ print($0)}).addDisposableTo(DisposeBag())
        Observable.of(10, 100, 1000).scan(0) { $0 + $1
            }.subscribe({ print($0)}).addDisposableTo(DisposeBag())
```

## è¿‡æ»¤å’Œçº¦æŸ

> è¿‡æ»¤å’Œçº¦æŸ

### `filter` è¿‡æ»¤æ‰æŸäº›ä¸ç¬¦åˆè¦æ±‚çš„äº‹ä»¶
```
Observable.of("ğŸ˜€", "ğŸ˜™", "ğŸ˜€", "ğŸ˜€", "ğŸ˜œ", "ğŸ˜", "ğŸ˜‡", "ğŸ˜—", "ğŸ˜˜", "ğŸ™ƒ", "ğŸ˜‰").filter { (str) -> Bool in
            return str == "ğŸ˜€"
            }.subscribe({ print($0)}).addDisposableTo(DisposeBag())
        Observable.range(start: 0, count: 100).filter { (num) -> Bool in
            return num % 2 == 0
            }.subscribe({ print($0)}).addDisposableTo(DisposeBag())
```
### `distinctUntilChanged` å½“ä¸‹ä¸€ä¸ªäº‹ä»¶ä¸å‰ä¸€ä¸ªäº‹ä»¶ä¸æ˜¯åŒä¸€ä¸ªäº‹ä»¶æ‰è¿›è¡Œå¤„ç†æ“ä½œ
```
Observable.of("âš½ï¸", "ğŸˆ", "ğŸ€", "âš¾ï¸", "âš¾ï¸", "âš¾ï¸", "ğŸ€", "âš½ï¸", "ğŸ€", "âš½ï¸", "âš½ï¸", "ğŸ¾", "ğŸ", "âš½ï¸", "ğŸ", "ğŸ").distinctUntilChanged().subscribe( { print($0)} ).addDisposableTo(DisposeBag())
```
### elementAt åªå¤„ç†åœ¨æŒ‡å®šä½ç½®çš„äº‹ä»¶
```
Observable.of("ğŸ¤", "ğŸ¼", "ğŸ¹", "ğŸ§").single().subscribe( { print($0) } ).addDisposableTo(DisposeBag())
```

>  error(Sequence contains more than one element.)

```
Observable.of("ğŸ¹", "ğŸ¹", "ğŸ§").single( {$0 == "ğŸ§"} ).subscribe( { print($0) } ).addDisposableTo(DisposeBag())
```

> completed

```
Observable.of("ğŸ¹", "ğŸ¹", "ğŸ§").single( {$0 == "ğŸ¹"} ).subscribe( { print($0) } ).addDisposableTo(DisposeBag())
```

> error(Sequence contains more than one element.)

```
Observable.of("ğŸ¹", "ğŸ¹", "ğŸ§").single( {$0 == "ğŸ¤"} ).subscribe( { print($0) } ).addDisposableTo(DisposeBag())
```

> error(Sequence doesn't contain any elements.)

### `take` åªå¤„ç†å‰å‡ ä¸ªäº‹ä»¶ä¿¡å·
```
Observable.of("â˜®ï¸", "â˜ªï¸", "ğŸ”¯", "â˜¯ï¸", "â™‰ï¸", "â™’ï¸").take(3).subscribe( { print($0) } ).addDisposableTo(DisposeBag())
```
### `takeLast` åªå¤„ç†åå‡ ä¸ªäº‹ä»¶ä¿¡å·
```
Observable.of("â˜®ï¸", "â˜ªï¸", "ğŸ”¯", "â˜¯ï¸", "â™‰ï¸", "â™’ï¸").takeLast(3).subscribe( { print($0) } ).addDisposableTo(DisposeBag())
```
### `takeWhile` å½“æ¡ä»¶æ»¡è¶³æ—¶å¤„ç†
```
Observable.range(start: 1, count: 5).takeWhile( { $0 <= 3} ).subscribe( { print($0) } ).addDisposableTo(DisposeBag())
```
### `takeUntil` æ¥æ”¶äº‹ä»¶æ¶ˆæ¯, ç›´åˆ°å¦ä¸€ä¸ªsequence å‘å‡ºäº‹ä»¶æ¶ˆæ¯çš„æ—¶å€™
```
let sourceSequence = PublishSubject<String>()
        let stopSequence = PublishSubject<String>()
        let takeUntilDisposeBag = DisposeBag()
        sourceSequence.takeUntil(stopSequence).subscribe( { print($0) } ).addDisposableTo(takeUntilDisposeBag)
        sourceSequence.onNext("â™»ï¸")
        sourceSequence.onNext("ğŸˆ¯ï¸")
        stopSequence.onNext("â›”ï¸")
        sourceSequence.onNext("ğŸ’¹")
```
### `skip` å–æ¶ˆå‰å‡ ä¸ªäº‹ä»¶
```
Observable.of("ğŸˆ¶", "ğŸˆ·ï¸", "ğŸˆº", "ğŸˆ¸", "ğŸˆšï¸").skip(2).subscribe( { print($0)} ).addDisposableTo(DisposeBag())
```
### `skipWhile` æ»¡è¶³äº‹ä»¶æ¶ˆæ¯çš„éƒ½å–æ¶ˆ, å½“é‡åˆ°ä¸æ»¡è¶³æ¡ä»¶çš„äº‹ä»¶æ¶ˆæ¯å,åé¢çš„å°±ä¸è€ƒè™‘äº†
```
Observable.of("ğŸˆ¶", "ğŸˆ·ï¸", "ğŸˆº", "ğŸˆ¸", "ğŸˆšï¸").skipWhile( { $0 == "ğŸˆ¶"} ).subscribe( { print($0)} ).addDisposableTo(DisposeBag())
        Observable.range(start: 0, count: 5).skipWhile( { $0 < 3} ).subscribe( { print($0)} ).addDisposableTo(DisposeBag())
```
### `skipWhileWithIndex` æ»¡è¶³æ¡ä»¶çš„éƒ½è¢«å–æ¶ˆ, å¯ä»¥æ ¹æ®å…ƒç´ å’Œä¸‹è¡¨åˆ†åˆ«å†³å®š, ä¼ å…¥çš„é—­åŒ…å’Œ`skipWhile`æœ‰ç‚¹åŒºåˆ«è€Œå·², å½“é‡åˆ°ä¸æ»¡è¶³æ¡ä»¶çš„äº‹ä»¶æ¶ˆæ¯å,åé¢çš„å°±ä¸è€ƒè™‘äº†
```
let skipWithIndexDisposeBag = DisposeBag()
        Observable.of("1ğŸˆ¶", "2ğŸ˜€", "1ğŸˆº", "ğŸˆ¸", "ğŸ˜…").skipWhileWithIndex { (element, index) -> Bool in
            return index != 3
            }.subscribe( { print("----", $0)} ).addDisposableTo(skipWithIndexDisposeBag)
```

> æ³¨: å½“é‡åˆ°ä¸æ»¡è¶³æ¡ä»¶çš„äº‹ä»¶æ¶ˆæ¯å,åé¢çš„å°±ä¸è€ƒè™‘äº†

### `skipUntil` çŸ¥é“æŸä¸ª`sequence`å‘å‡ºäº†äº‹ä»¶æ¶ˆæ¯, æ‰å¼€å§‹æ¥æ”¶å½“å‰`sequence`å‘å‡ºçš„äº‹ä»¶æ¶ˆæ¯
```
let skipUntilDisposeBag = DisposeBag()
        let skipUntilStartSubject = PublishSubject<String>()
        let skipUntilStopSubject = PublishSubject<Int>()
        skipUntilStartSubject.skipUntil(skipUntilStopSubject).subscribe( { print($0) } ).addDisposableTo(skipUntilDisposeBag)
        skipUntilStartSubject.onNext("ğŸ ")
        skipUntilStartSubject.onNext("ğŸŸ")
        
        skipUntilStopSubject.onNext(0)// skipUntilStopSubject æ¥æ”¶æ¶ˆæ¯å, skipUntilStartSubjectæ‰ä¼šå¼€å§‹æ¥æ”¶æ¶ˆæ¯
        
        skipUntilStartSubject.onNext("ğŸ¡")
        skipUntilStartSubject.onNext("ğŸ¬")
```

> æ³¨:   `skipUntilStopSubject` æ¥æ”¶æ¶ˆæ¯å, `skipUntilStartSubject`æ‰ä¼šå¼€å§‹æ¥æ”¶æ¶ˆæ¯

## æ•°å­¦æ“ä½œ

> æ•°å­¦æ“ä½œ

### `toArray` å°†`sequence`è½¬æ¢æˆä¸€ä¸ª`Array`, å¹¶è½¬æ¢æˆå•ä¸€äº‹ä»¶ä¿¡å·, ç„¶åç»“æŸ
```
Observable.range(start: 1, count: 10).toArray().subscribe( { print($0) } ).addDisposableTo(DisposeBag())
```
### `reduce` ç”¨ä¸€ä¸ªåˆå§‹å€¼, å¯¹äº‹ä»¶æ•°æ®è¿›è¡Œç´¯è®¡æ“ä½œ. `reduce` æ¥æ”¶ä¸€ä¸ªåˆå§‹å€¼,å’Œä¸€ä¸ªæ“ä½œç¬¦
```
Observable.of(10, 100, 1000).reduce(1, accumulator: +).subscribe( { print($0) } ).addDisposableTo(DisposeBag())
```
### `concat` (åˆå¹¶) æŠŠå¤šä¸ª`sequence` åˆå¹¶ä¸º ä¸€ä¸ª `sequence`, å¹¶ä¸”å½“å‰é¢ä¸€ä¸ª`sequence`å‘å‡ºäº†`complete`äº‹ä»¶, æ‰ä¼šå¼€å§‹ä¸‹ä¸€ä¸ª`sequence`äº‹ä»¶
```
let concatDisposeBag = DisposeBag()
        let concatBehaviorSubject1 = BehaviorSubject(value: "â˜€ï¸")
        let concatBehaviorSubject2 = BehaviorSubject(value: "ğŸ")
        
        let concatVariable = Variable(concatBehaviorSubject1)
        concatVariable.asObservable().concat().subscribe( { print($0) } ).addDisposableTo(concatDisposeBag)
        
        concatBehaviorSubject1.onNext("ğŸŒ§")
        concatBehaviorSubject1.onNext("â„ï¸")
        concatVariable.value = concatBehaviorSubject2
        concatBehaviorSubject2.onNext("ğŸ“")
        concatBehaviorSubject1.onCompleted()
        concatBehaviorSubject2.onNext("ğŸ’")
        concatBehaviorSubject2.onNext("ğŸ‰")
        concatBehaviorSubject1.onNext("â›…ï¸")
```

> next(â˜€ï¸)
         next(ğŸŒ§)
         next(â„ï¸)
         next(ğŸ“)
         next(ğŸ’)
         next(ğŸ‰)

## è¿æ¥æ€§æ“ä½œ

> Connectable Observable è®¢é˜…æ—¶ä¸å¼€å§‹å‘å°„äº‹ä»¶æ¶ˆæ¯, è€Œæ˜¯ä»…å½“è°ƒç”¨ä»–ä»¬çš„connec() æ–¹æ³•æ—¶.
è¿™æ ·å°±å¯ä»¥ç­‰å¾…æˆ‘ä»¬æ‰€æœ‰æƒ³è¦çš„è®¢é˜…è€…éƒ½è®¢é˜…äº†ä»¥åå†å¼€å§‹å‘äº‹ä»¶æ¶ˆæ¯, è¿™æ ·èƒ½ä¿è¯æˆ‘ä»¬æ‰€æœ‰çš„è®¢é˜…è€…éƒ½èƒ½å¤Ÿæ¥æ”¶åˆ°äº‹ä»¶æ¶ˆæ¯. ç®€å•è¯´å°±æ˜¯ç­‰å¤§å®¶éƒ½å‡†å¤‡å®Œæˆå, æ‰å¼€å§‹å‘æ¶ˆæ¯

### ä¾‹: æ¯éš”ä¸€ç§’ å‘é€ä¸€ä¸ªäº‹ä»¶
```
let interval = Observable<Int>.interval(1, scheduler: MainScheduler.instance)
       _ = interval.subscribe(onNext: { print("Subscription: 1, Event: \($0)") })
       DispatchQueue.main.asyncAfter(deadline: DispatchTime.now() + 5) {
           _ = interval.subscribe(onNext: { print("Subscription: 2, Event: \($0)") })
       }
```
### `publish` å°†ä¸€ä¸ªæ­£å¸¸çš„`sequence` è½¬æ¢ä¸º `connectable sequence`, å¯ä»¥æŒ‡å®šæ—¶é—´å‘é€äº‹ä»¶
```
let intSequence = Observable<Int>.interval(1, scheduler: MainScheduler.instance).publish()
       _ = intSequence.subscribe(onNext: { print("Subscription: 1, Event: \($0)") })
       DispatchQueue.main.asyncAfter(deadline: DispatchTime.now() + 2) {
           _ = intSequence.connect()
       }
       DispatchQueue.main.asyncAfter(deadline: DispatchTime.now() + 4) {
           _ = intSequence.subscribe(onNext: { print("Subscription: 2, Event: \($0)") })
       }
       DispatchQueue.main.asyncAfter(deadline: DispatchTime.now() + 6) {
           _ = intSequence.subscribe(onNext: { print("Subscription: 3, Event: \($0)") })
       }
```
### `replay` è®²ä¸€ä¸ªæ­£å¸¸çš„`sequence` è½¬æ¢æˆä¸€ä¸ª`connectable sequence`, ç„¶åå’Œ`replaySubject`çš„`bufferSizeç›¸ä¼¼, èƒ½æ¥æ”¶åˆ°è®¢é˜…ä¹‹å‰çš„äº‹ä»¶æ¶ˆæ¯
```
let replaySequence = Observable<Int>.interval(1, scheduler: MainScheduler.instance).replay(1) // èƒ½æ¥æ”¶åˆ°è®¢é˜…ä¹‹å‰çš„næ¡ä¿¡æ¯
       _ = replaySequence.subscribe( { print("ç¬¬1ä¸ªè®¢é˜…è€…--Event", $0)} )
       DispatchQueue.main.asyncAfter(deadline: DispatchTime.now() + 1) {
           _ = replaySequence.connect()
       }
       
       DispatchQueue.main.asyncAfter(deadline: DispatchTime.now() + 4) {
           _ = replaySequence.subscribe( { print("ç¬¬2ä¸ªè®¢é˜…è€…--Event", $0)} )
       }
       
       DispatchQueue.main.asyncAfter(deadline: DispatchTime.now() + 6) {
           _ = replaySequence.subscribe( { print("ç¬¬3ä¸ªè®¢é˜…è€…--Event", $0)} )
       }
```
### `multicast` å°†ä¸€ä¸ªæ­£å¸¸çš„`sequence` è½¬æ¢ä¸º `connectable sequence` , å¹¶ä¸”é€šè¿‡ç‰¹å®šçš„`subject`å‘é€å‡ºå», ä¾‹: `publishSubject`, `replaySubject`, `behaviorSubject`, `Variable`
```
let subject = PublishSubject<Int>()
        _ = subject.subscribe( { print("subject1--", $0) } )
        let multicastSequence = Observable<Int>.interval(1, scheduler: MainScheduler.instance).multicast(subject)
        _ = multicastSequence.subscribe( { print("subject2--", $0) } )
        DispatchQueue.main.asyncAfter(deadline: DispatchTime.now() + 2) { 
            _ = multicastSequence.connect()
        }
        DispatchQueue.main.asyncAfter(deadline: DispatchTime.now() + 4) {
            _ = multicastSequence.subscribe( { print("subject3--", $0) } )
        }
```

## é”™è¯¯å¤„ç†

> é”™è¯¯å¤„ç†

### `catchErrorJustReturn` é‡åˆ°'error'çš„æ—¶å€™å°±'return'ä¸€ä¸ªå€¼, ç„¶åç»“æŸ
```
let justReturnDisposeBag = DisposeBag()
        let justReturnSubject = PublishSubject<String>()
        justReturnSubject.catchErrorJustReturn("ğŸ˜±").subscribe( { print($0) } ).addDisposableTo(justReturnDisposeBag)
        justReturnSubject.onNext("â˜ºï¸")
        justReturnSubject.onNext("ğŸ˜‹")
        justReturnSubject.onNext("ğŸ˜")
        justReturnSubject.onError(NSError(domain: "â", code: 1000001, userInfo: nil) as Error)
```
### `catchError` æ•è·`error`è¿›è¡Œå¤„ç†, å¯ä»¥è¿”å›å¦ä¸€ä¸ª`sequence` è¿›è¡Œè®¢é˜…
```
let catchErrorDisposeBag = DisposeBag()
        let catchErrorSubject1 = PublishSubject<String>()
        let catchErrorSubject2 = PublishSubject<String>()
        catchErrorSubject1.catchError { (error) -> Observable<String> in
            print("errro: ---\(error)")
            return catchErrorSubject2
            }.subscribe( { print($0) } ).addDisposableTo(catchErrorDisposeBag)
        catchErrorSubject1.onNext("ğŸ˜€")
        catchErrorSubject1.onNext("ğŸ˜¬")
        catchErrorSubject2.onNext("ğŸ˜‚") // ä¸ä¼šæ‰“å°, å½“subject1 é‡åˆ°errorå, subject2 æ‰ä¼šè¢«è®¢é˜…
        
        catchErrorSubject1.onError(NSError(domain: "â", code: 1000001, userInfo: nil) as Error)
        catchErrorSubject2.onNext("ğŸ¤‘") // ä¼šæ‰“å°, å› ä¸ºå·²ç»è¢«è®¢é˜…äº†
```
### `retry` (é‡è¯•) é‡è§`error`äº‹ä»¶å¯ä»¥è¿›è¡Œé‡è¯•, æ¯”å¦‚ç½‘ç»œè¯·æ±‚å¤±è´¥, å¯ä»¥è¿›è¡Œé‡æ–°è¿æ¥
```
let retryDisposeBag = DisposeBag()
        var count = 1
        let myRetrySequence = Observable<String>.create { (observer) -> Disposable in
            observer.onNext("----1")
            observer.onNext("----2")
            observer.onNext("----3")
            if count <= 2 {
                let error = NSError(domain: "â", code: 1000001, userInfo: nil) as Error
                observer.onError(error)
                print(error)
                count += 1
            }
            observer.onNext("----4")
            observer.onCompleted()
            
            return Disposables.create()
        }
myRetrySequence.retry(5).subscribe( { print($0) } ).addDisposableTo(retryDisposeBag)
```
> `retry()` æ— é™é‡å¤--- ç›´åˆ°æˆåŠŸ

```
myRetrySequenceretry().subscribe( { print($0) } ).addDisposableTo(retryDisposeBag)
```

## debug

> debug

### `debug` æ‰“å°æ‰€æœ‰çš„è®¢é˜…, äº‹ä»¶, å’Œ`disposals`
```
myRetrySequence.debug().retry(5).subscribe( { print($0) } ).addDisposableTo(retryDisposeBag)
```
### RxSwift.Resources.total æŸ¥çœ‹RxSwift æ‰€æœ‰èµ„æºçš„å ç”¨
```
print(RxSwift.Resources.total)
```

> RxSwift.Resources.total æ²¡èƒ½è°ƒç”¨æˆåŠŸ ğŸ˜‚

# ä»£ç ç¨åä¼šä¸Šä¼ åˆ°github, éœ€è¦æŸ¥çœ‹ç»“æœçš„å°ä¼™ä¼´å¯ä»¥ä¸‹è½½è¿è¡Œ

# å†™åœ¨æœ€å æœ¬äººiOSå¼€å‘èœé¸Ÿä¸€æš, ä¸å¦¥ä¹‹å¤„,è¿˜æœ›å¤§ç¥æŒ‡æ•™~~~~~~~~~~~

[jekyll-docs]: https://jekyllrb.com/docs/home
[jekyll-gh]:   https://github.com/jekyll/jekyll
[jekyll-talk]: https://talk.jekyllrb.com/


